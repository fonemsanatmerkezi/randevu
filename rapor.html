const API_URL = "https://script.google.com/macros/s/AKfycbwgV6kTyeafxp9YcODP6rZYh3kt2YFDdybBLVMfgvdzyz_YViTrHLYFz6hWpsJhPBJO/exec";

function raporGetir() {
  const bas = document.getElementById("baslangic").value;
  const bit = document.getElementById("bitis").value;

  let url = API_URL;
  if (bas && bit) {
    url += `?baslangic=${bas}&bitis=${bit}`;
  }

  fetch(url)
    .then(r => r.json())
    .then(data => {
      const alan = document.getElementById("raporAlan");
      alan.innerHTML = "";

      if (data.length === 0) {
        alan.innerHTML = "<p>âŒ Randevu bulunamadÄ±</p>";
        return;
      }

      data.forEach(r => {
        alan.innerHTML += `
          <div class="kart">
            <b>${r[1]}</b><br>
            ğŸ“ ${r[2]}<br>
            ğŸ“… ${r[3]} ${r[4]}<br>
            ğŸ‘¥ ${r[5]} | ğŸ  ${r[6]}<br>
            ğŸ’³ ${r[7]}<br>
            ğŸ“ ${r[8]}
          </div>
        `;
      });
    })
    .catch(() => {
      document.getElementById("raporAlan").innerHTML =
        "<p>âš ï¸ Rapor alÄ±nÄ±rken hata oluÅŸtu</p>";
    });
}
